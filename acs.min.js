function saveData(e,n){var o=document.getElementById("pin_type").value,t=document.getElementById("description").value,i=document.getElementById("pin_affected").value,a="process/pin_map.php?add_location=1&type="+encodeURIComponent(o)+"&description="+encodeURIComponent(t)+"&affected="+encodeURIComponent(i)+"&lat="+e+"&long="+n;""!=t?downloadUrl(a,function(o,t){if(200==t){var i=getMarkerUniqueId(e,n),a=markers[i];a.setIcon(admin_icon),infowindow.close(),infowindow.setContent("<div class='text-dark fw-bold'>Resident's location is set!</div>"),infowindow.close()}else infowindow.setContent("<div class='text-danger fw-bold'>Oops! It seems mapping resident's location could not set.</div>")}):infowindow.setContent("<div style='color: red; font-size: 14px;'>Input fields are required! Don't leave it empty.</div>")}function downloadUrl(e,n){var o=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;o.onreadystatechange=function(){4==o.readyState&&n(o.data,o.status)},o.open("GET",e,!0),o.send(null)}var map,red_icon="http://maps.google.com/mapfiles/ms/icons/red-dot.png",admin_icon="img/icons/pin-location-2.png",dot_icon={url:"img/icons/search.png",scaledSize:new google.maps.Size(50,50)},locations="",markers={},card=document.getElementById("autoCompleteSearch"),input=document.getElementById("autoCompleteSearchInput");map.controls[google.maps.ControlPosition.TOP_CENTER].push(card);var autocomplete=new google.maps.places.Autocomplete(input),infowindow=new google.maps.InfoWindow,getMarkerUniqueId=function(e,n){return e+"_"+n},getLatLng=function(e,n){return new google.maps.LatLng(e,n)},bindMarkerinfo=function(e){google.maps.event.addListener(e,"click",function(e){var n=getMarkerUniqueId(e.latLng.lat(),e.latLng.lng()),o=markers[n];infowindow=new google.maps.InfoWindow,infowindow.setContent(o.html),infowindow.open(map,o)})},bindMarkerEvents=function(e){google.maps.event.addListener(e,"rightclick",function(e){var n=getMarkerUniqueId(e.latLng.lat(),e.latLng.lng()),o=markers[n];removeMarker(o,n)})},removeMarker=function(e,n){e.setMap(null),delete markers[n]};autocomplete.addListener("place_changed",function(){var e=autocomplete.getPlace(),n=e.geometry.location.lat(),o=e.geometry.location.lng(),t=getMarkerUniqueId(n,o),i=new google.maps.Marker({position:getLatLng(n,o),map:map,animation:google.maps.Animation.DROP,id:"marker_"+t,html:"    <div id='info_"+t+"'>\n        <div class='map1'>\n           <div class='d-grid gap-4 p-2'>\n             <div class='d-grid'>\n               <span class='form-label fw-semibold'>Type</span>\n               <select name='type' id='pin_type' class='form-select'>\n                 <option value='Earthquake'>Earthquake</option>\n                 <option value='Fire'>Fire</option>\n                 <option value='Flood'>Flood</option>\n                 <option value='Tsunami'>Tsunami</option>\n               </select>\n             </div>\n             <div class='d-grid'>\n               <span class='form-label fw-semibold'>Total Number to Rescue</span>\n               <select name='type' id='pin_affected' class='form-select'>\n                 <option value='One (1)'>1</option>\n                 <option value='Two (2)'>2</option>\n                 <option value='3 to 5'>3 to 5</option>\n                 <option value='5 to 10'>5 to 10</option>\n                 <option value='10 above'>10 above</option>\n               </select>\n             </div>\n             <div class='d-grid'>\n               <span class='form-label fw-semibold'>Current Situation</span>\n               <textarea id='description' placeholder='Current Situation' required class='form-control h-150px w-250px' spellcheck='false'></textarea>\n             </div>\n            <div class='d-flex'>\n               <input type='button' class='btn btn-primary w-100 shadow-sm' id='save_map' value='Save' onclick='saveData("+n+","+o+")'/>\n            </div>\n         </div>\n       </div>\n    </div>"});e.geometry&&(infowindow.close(),i.setVisible(!1),markers[t]=i,bindMarkerEvents(i),bindMarkerinfo(i),map.fitBounds(e.geometry.viewport),i.setIcon(dot_icon),i.setPosition(e.geometry.location),i.setVisible(!0),infowindow.setContent(i.html),infowindow.open(map,i))});
